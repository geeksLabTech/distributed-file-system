
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cliente/">
      
      
        <link rel="next" href="../ejemplos/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>Descripción del sistema - Kade Drive DHT</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#descripcion-del-sistema" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Kade Drive DHT" class="md-header__button md-logo" aria-label="Kade Drive DHT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kade Drive DHT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Descripción del sistema
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../index.html" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="../index.html" hreflang="es" class="md-select__link">
                    Español
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Kade Drive DHT" class="md-nav__button md-logo" aria-label="Kade Drive DHT" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Kade Drive DHT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../autodiscovery/" class="md-nav__link">
        Autodiscovery
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cap-analysis/" class="md-nav__link">
        Cap analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../client/" class="md-nav__link">
        Client
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../description/" class="md-nav__link">
        Description
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../fault-tolerance/" class="md-nav__link">
        Fault Tolerance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation-setup/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../persistence/" class="md-nav__link">
        Persistence
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../recommendations/" class="md-nav__link">
        Recommendations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../replication/" class="md-nav__link">
        Replication
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../why-kademlia/" class="md-nav__link">
        Why Kademlia?
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked>
      
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          Es
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Es
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analisis-cap/" class="md-nav__link">
        Análisis del teorema CAP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../autodescubrimiento/" class="md-nav__link">
        Autodescubrimiento
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cliente/" class="md-nav__link">
        Cliente
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Descripción del sistema
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ejemplos/" class="md-nav__link">
        eJEMPLOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../instalaci%C3%B3n/" class="md-nav__link">
        Instalación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../persistencia/" class="md-nav__link">
        Persistencia
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../por-que-kademlia/" class="md-nav__link">
        ¿Por qué Kademlia?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../recomendaciones/" class="md-nav__link">
        Recomendaciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../replicacion/" class="md-nav__link">
        Replicación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tolerancia-fallas/" class="md-nav__link">
        Tolerancia a Fallas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="descripcion-del-sistema">Descripción del sistema</h1>
<p>Al igual que muchos sistemas de tabla de hash distribuida, las llaves se almacenan en 160 bits. Cada uno de los ordenadores participantes en la red tiene un ID, y los pares (llave, valor) son almacenados en nodos con ID "cercanos", tomando como métrica de distancia la métrica XOR propuesta por Kademlia.</p>
<p>Al igual que Kademlia, se tratan los nodos como hojas de un árbol binario, en el que la posición de cada nodo viene determinada por el prefijo "único más corto" de su ID. Dichos nodos almacenan información de contacto entre sí para enrutar los mensajes de consulta.</p>
<p>Se usa como base el protocolo de Kademlia que garantiza que cada nodo conoce al menos un nodo de cada uno de sus subárboles (si contiene algún nodo); con esta garantía, cualquier nodo puede localizar a otro nodo por su ID.</p>
<p>Se cuenta con un módulo de persistencia llamado PersistentStorage que funciona de la siguiente manera:
Utiliza las rutas:</p>
<ul>
<li>static/metadata: los nombres de los ficheros en esta ruta representan el hash de unos datos que se dividieron en varios chunks de tamaño máximo 1000kb. Contienen como valor listas de Python guardadas con pickle que tienen los hashes de cada chunk obtenido al picar unos datos determinados.</li>
<li>static/keys: los nombres de los ficheros en esta ruta representan todos los hashes de los datos almacenados, ya sea correspondiente a un dato completo o a un chunk de este. Contienen como valor los hashes correspondientes en bytes.</li>
<li>static/values: los nombres de los ficheros en esta ruta representan los hashes de todos los chunks que se han almacenado, excluyendo hashes de datos sin picar.</li>
<li>
<p>timestamps: los nombres de los ficheros en esta ruta representan todos los hashes de los datos almacenados, al igual que la ruta de keys, pero contienen como valor un diccionario de Python guardado con pickle que tiene como llaves "date" con el valor "datetime.now()" y "republish" con un valor booleano. Esto se usa para llevar un registro de la última vez que se accedió a `una llave y para saber si es necesario que el nodo que la contiene la republique porque es accedida con frecuencia.</p>
</li>
<li>
<p>Cuando recibe un par (llave, valor), ambos de tipo bytes, codifica la llave
usando base64.urlsafeb64encode para poder obtener un string que se pueda usar como nombre de un fichero, se escribe un fichero con ese nombre en en la ruta de keys y de values, de manera tal que en el de key se escriba
la llave en bytes y en el de values el valor en bytes. En el caso de que se
especifique que el par a guardar es metadata el fichero que contendr´a al
valor en bytes se escribe en la ruta de metadata. En ambos casos se crea
un fichero en la ruta de timestamps con el nombre correspondiente.</p>
</li>
</ul>
<p>El protocolo de Kademlia contiene cuatro RPCs : PING , STORE , FINDNODE y FIND-VALUE[2]. Esta propuesta adem´as de usar estos cuatro RPCs,
implementa CONTAINS, BOOTSTRAPPABL-NEIGHBOR, GET, GET-FILECHUNKS, UPLOAD-FILE, SET-KEY y FIND-NEIGHBORS</p>
<ul>
<li>CONTAINS: Detecta si una llave est´a en un nodo, esto se utiliza tanto
para la replicaci´on de la informaci´on como para encontrar si un nodo tiene
la informaci´on que se desea</li>
<li>BOOTSTRAPPABLE-NEIGHBOR</li>
<li>GET: Obtiene la informaci´on identificada con la llave de un chunk</li>
<li>GET-FILE-CHUNKS: Obtiene la lista de ubicaciones de los chunks de la
informaci´on.</li>
<li>UPLOAD-FILE: Sube el archivo al sitema de ficheros, lo pica en los chunks
y guarda la metadata del archivo con la forma de unificar todos los ficheros.</li>
<li>SET-KEY</li>
<li>FIND-NEIGHBORS:</li>
</ul>
<p>Se utiliz´o la misma estructura de tablas de enrutamiento que Kademlia, la
tabla de enrutamiento es un ´arbol binario cuyas hojas son k-buckets. Cada kbucket contiene nodos con alg´un prefijo com´un en sus ID. El prefijo es la posici´on
del k-bucket en el ´arbol binario, por lo que cada k-bucket cubre una parte del
espacio de ID y, juntos, los k-buckets cubren todo el espacio de ID de 160 bits
sin solaparse. Los nodos del ´arbol de enrutamiento se asignan din´amicamente,
seg´un sea necesario.
Para garantizar la correcta replicaci´on de los datos, los nodos deben volver a
publicar peri´odicamente las llaves. De lo contrario, dos fen´omenos pueden hacer
que fallen las b´usquedas de llaves v´alidas. En primer lugar, algunos de los k
nodos que obtienen inicialmente un par llave-valor cuando se publica pueden
abandonar la red. En segundo lugar, pueden unirse a la red nuevos nodos con
ID m´as cercanos a alguna llave publicada que los nodos en los que se public´o
originalmente el par llave-valor. En ambos casos, los nodos con el par llave-valor
deben volver a publicar para asegurarse de que est´a disponible en los k nodos
m´as cercanos a la llave.
Una vez que un cliente pide al sistema un determinado valor, se le devuelve
una lista de las ubicaciones de los distintos chunks de datos (no necesariamente
estos se encuentran en la misma PC) y se crea una conexi´on con la PC m´as
cercana a la informaci´on de forma tal que la red no se sature innecesariamente.
Luego el cliente unifica los datos y devuelve el valor almacenado. Una vez que un
nodo env´ıa cierta informaci´on, marca ese archivo como pendiente de republicar
y actualiza su timestamp, de manera que se informa a cada uno de los vecinos
en los que se debe replicar la informaci´on que esta fue accedida y no ha de ser
eliminada</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>